<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="tinymce.min.js" referrerpolicy="origin"></script>

    <script type="text/javascript" type="text/ecmascript-6">
      
    tinymce.init({
    selector: '#editor',
    plugins: 'autoresize print preview paste importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern noneditable help charmap quickbars emoticons',
      imagetools_cors_hosts: ['picsum.photos'],
      toolbar: 'customPDF undo redo | bold italic underline strikethrough | fontselect fontsizeselect formatselect | alignleft aligncenter alignright alignjustify | outdent indent |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen  preview save print | insertfile image media template link anchor codesample | ltr rtl',

autoresize_bottom_margin: 50,
min_height: 500,
    paste_data_images: true,

    images_upload_url : 'postAcceptor.php',
    automatic_uploads : false,

    // convert url for image to proper format
    urlconverter_callback: function(url, node, on_save){

        if (url.substring(0,4)!="http")
        {
            url = url.replace("\"","");
            url = url.replace("\"","");

            url= 'file://' + url;

            sendToJava(url);
        }

        return (url);



    },

    // custom button to convert editor content to PDF

    setup: function(editor) {
      editor.ui.registry.addButton('customPDF', {
          text: 'In PDF',
          onAction: function (_) {
            sendHtml(tinyMCE.activeEditor.getContent());
          }
      });
      editor.on('init', function(e) {
        editor.execCommand('mceFullScreen');
      });
    },


   });



    function encode_utf(text){
    	return unescape(encodeURIComponent(text));
    };
    function decode_utf(text){
    	return decodeURIComponent(text);
    };

    function sendHtml(text)
    {
    	javaConnector.saveHtml(text);
    }

    function sendToJava (text) {
        javaConnector.toLowerCase(text);

    };

    var jsConnector = {
        showResult: function (result) {
            document.getElementById('result').innerHTML = result;
        }
    };

    function getJsConnector() {
        return jsConnector;
    };


    </script>



</head>

<body>
    <form method="post">
    <textarea id="editor">Hello, World!
    </textarea>
    </form>
</body>
</html>
